extends layout

block content  
  script(src="../javascripts/phaser.min.js")
  
  script(src="../javascripts/src/boot.js")
  script(src="../javascripts/src/preload.js")
  script(src="../javascripts/src/gameTitle.js") 
  script(src="../javascripts/src/bootDealer.js")
  script(src="../javascripts/src/preloadDealer.js")
  script(src="../javascripts/src/gameTitleDealer.js")
  script(src="../javascripts/src/loteriaDealer.js")
  script(src="../javascripts/src/loteria.js")
  script(src="../javascripts/src/gameOver.js")
  script(src="../javascripts/src/gameOverDealer.js")
  script.
    var gameID = "#{gameID}";
    var dealer = "#{dealer}";
    var nickname = "#{nickname}";
    var boardLayout = "#{boardLayout}";
    
    console.log("On jade (gameID) " + gameID);
    console.log("On jade (nickname) " + nickname);
    console.log("On jade (dealer) " + dealer);
    var gameDealer = new Phaser.Game(300, 500, Phaser.AUTO, "gameDealer");
    var gameLoteria = new Phaser.Game(300, 500, Phaser.AUTO, "gameLoteria");
    gameDealer.state.add("BootDealer", boot);
    gameDealer.state.add("PreloadDealer", preloadDealer);
    gameDealer.state.add("GameTitleDealer", gameTitleDealer);
    gameLoteria.state.add("Boot", boot);
    gameLoteria.state.add("Preload", preload);
    gameLoteria.state.add("GameTitle", gameTitle);
    

    var deckSize = 0;
    var turn = 0;
    var cardsDealt = [];
    var cardNumber = 0;
    var deck = [];
    gameDealer.state.add("Loteria", loteriaDealer); 
    gameLoteria.state.add("Loteria", loteria); 
    nextCard();
    var gameBoard = generateBoard(boardLayout);
    var imageBoard = imageBoardFrom(gameBoard);
    gameLoteria.state.start("Boot");
    gameLoteria.state.add("GameOver", gameOver);
    gameDealer.state.start("BootDealer");
    gameDealer.state.add("GameOverDealer", gameOver);
    
    function imageBoardFrom(board) {
      var output = [];
      var size = board.length;
      var i = 0;
      while (i < 16) {
        //- if (size == 8 && ![0,3,5,6,9,10,12,15].includes(i)) {
          // fill in with blank
          //- output.push('-');
        //- } else {
          output.push('card_' + board[i] + '.png');
          i++;
        //- }
        
      }
      console.log("imageboard: " + output);
      return output;
    }
    function nextCard() {
      console.log("next card");
      turn ++;
      cardNumber = deck[turn];
      cardsDealt.push(cardNumber);
      console.log('turn: ' + turn);
      console.log('cardnumber: ' + cardNumber);
      }
    
    function generateBoard(layout) {
      var output = [];
      var random = 0;
      var size = 0;
      size = 16;
      for (var i = 0; i < size; i++) {
        do {
          random = ((Math.floor(Math.random() * 100)) % 54) + 1 ; // 1 -> (size)
        } while (output.includes(random));
        output.push(random);
      }
      
      console.log('board output: ' + output);
      return output;
    };
  
  div(id="gameDealer" class="vertical-center") 
      h1 Baraja 
      button(onclick="nextCard()" class="btn btn-default btn-block") Siguiente Carta

  div(id="gameLoteria" class="vertical-center") 
      h1 Tablero 